(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ab59965"],{"0f04":function(t,e,n){"use strict";n("108c")},1:function(t,e){},"108c":function(t,e,n){},"1c4c":function(t,e,n){"use strict";var i=n("9b43"),r=n("5ca1"),a=n("4bf8"),o=n("1fa8"),s=n("33a4"),c=n("9def"),f=n("f1ae"),u=n("27ee");r(r.S+r.F*!n("5cc5")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,l,d=a(t),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,m=void 0!==v,b=0,g=u(d);if(m&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==g||h==Array&&s(g))for(e=c(d.length),n=new h(e);e>b;b++)f(n,b,m?v(d[b],b):d[b]);else for(l=g.call(d),n=new h;!(r=l.next()).done;b++)f(n,b,m?o(l,v,[r.value,b],!0):r.value);return n.length=b,n}})},2:function(t,e){},3:function(t,e){},"37af":function(t,e,n){t.exports=n.p+"static/img/after.9e61207b.png"},4:function(t,e){},"4f7f":function(t,e,n){"use strict";var i=n("c26b"),r=n("b39a"),a="Set";t.exports=n("e0b8")(a,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,a),t=0===t?0:t,t)}},i)},5:function(t,e){},"5dbc":function(t,e,n){var i=n("d3f4"),r=n("8b97").set;t.exports=function(t,e,n){var a,o=e.constructor;return o!==n&&"function"==typeof o&&(a=o.prototype)!==n.prototype&&i(a)&&r&&r(t,a),t}},"5df3":function(t,e,n){"use strict";var i=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},6:function(t,e){},"67ab":function(t,e,n){var i=n("ca5a")("meta"),r=n("d3f4"),a=n("69a8"),o=n("86cc").f,s=0,c=Object.isExtensible||function(){return!0},f=!n("79e5")((function(){return c(Object.preventExtensions({}))})),u=function(t){o(t,i,{value:{i:"O"+ ++s,w:{}}})},l=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[i].i},d=function(t,e){if(!a(t,i)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[i].w},h=function(t){return f&&p.NEED&&c(t)&&!a(t,i)&&u(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:l,getWeak:d,onFreeze:h}},"7f7f":function(t,e,n){var i=n("86cc").f,r=Function.prototype,a=/^\s*function ([^ (]*)/,o="name";o in r||n("9e1e")&&i(r,o,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},"8b97":function(t,e,n){var i=n("d3f4"),r=n("cb7c"),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},"8ba5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"member-form"},[n("breadcrumb"),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"title"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),t._m(0),t._v(" "),n("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:t.form,"label-width":"84px"}},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.form.materialList,"highlight-current-row":"",border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"idcName",label:"材料名称",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v("\n                "+t._s(n.name)+"\n              ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"上传材料预览",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"table-imgBox"},[t._l(e.row.imgs,(function(i,r){return n("div",{key:r,staticClass:"table-imgLi"},[t.judgeIsPdf(i)?n("div",{staticClass:"pdf",on:{click:function(e){return t.handlePreview(i)}}},[n("pdf",{staticClass:"table-img",staticStyle:{overflow:"hidden"},attrs:{src:t.baseUrl+i}})],1):n("img",{staticClass:"table-img",attrs:{src:t.$utils.getFile(i)},on:{click:function(e){return t.handlePreview(i)}}}),t._v(" "),n("span",{staticClass:"table-imgSpan",on:{click:function(n){return t.handleDel(e.$index,r)}}},[t._v("删除")])])})),t._v(" "),0===e.row.imgs.length?n("div",{staticStyle:{color:"red"}},[t._v("请上传对应的材料")]):t._e()],2)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("upload-code",{attrs:{placement:"bottom-start",alias:e.$index},on:{update:t.updateFileList}})]}}])})],1)],1)],1),t._v(" "),n("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[n("el-button",{on:{click:function(e){return t.handleSaveDraft(!0)}}},[t._v("暂存草稿")]),t._v(" "),n("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("上一步")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.handleNext}},[t._v("下一步")])],1)],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.isPicturePreview},on:{"update:visible":function(e){t.isPicturePreview=e}}},[n("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),t._v(" "),n("el-dialog",{attrs:{visible:t.isPdfPreview,width:"70%"},on:{"update:visible":function(e){t.isPdfPreview=e}}},[n("embed",{staticStyle:{overflow:"hidden",width:"100%",height:"500px"},attrs:{src:t.dialogPdfUrl,type:"application/pdf"}})])],1)},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tips"},[i("img",{attrs:{src:n("37af")}}),t._v(" "),i("span",[t._v("支持JPG,PNG,PDF")])])}],a=n("5530"),o=(n("4f7f"),n("5df3"),n("1c4c"),n("7f7f"),n("ac6a"),n("c7eb")),s=(n("96cf"),n("1da1")),c=n("6350"),f=n("81f7"),u=n("858e"),l={components:{Breadcrumb:c["a"],UploadCode:f["a"],pdf:u["a"]},data:function(){return{isPicturePreview:!1,isPdfPreview:!1,dialogImageUrl:"",dialogPdfUrl:"",baseUrl:"",form:{materialList:[]}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo}},created:function(){var t=this;this.$utils.getItem("draftNumber")&&this.$store.dispatch("draft/getDraftDetail",this.$utils.getItem("draftNumber")).then(function(){var e=Object(s["a"])(Object(o["a"])().mark((function e(n){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.uploadMaterial&&(t.form=n.uploadMaterial);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.baseUrl=window.location.origin+"".concat(this.$utils.getPrefix(),"/open-platform/");var e=[],n=this.$utils.getItem("business");console.log(n),n.mainForm.forEach((function(t,n){"食品销售经营者"===t.name?(e.push({name:"与食品销售相适应的设施设备清单及布局示意图（布局示意图上应标明长、宽，并注明面积）",imgs:[]}),t.childs.forEach((function(t,n){!t.isSel||"含自动售货"!==t.name&&"自动售货"!==t.name||(e.push({name:"与食品销售相适应的设施设备清单及布局示意图（布局示意图上应标明长、宽，并注明面积）",imgs:[]}),e.push({name:"自动售货设备的产品合格证明、具体放置地点，经营者名称、住所、联系方式、食品经营许可证的公示方法等",imgs:[]})),!t.isSel||"网络经营"!==t.name&&"含网络经营"!==t.name||e.push({name:"符合食品安全要求的产品包装材料证明，以及与经营规模相适应、符合配送要求的设施设备等有关资料（运输车辆、容器等）",imgs:[]})}))):"餐饮服务经营者"===t.name?(e.push({name:"经营场所、设备布局、加工流程、卫生设施等平面示意图及说明和经营设备或者设施清单（布局示意图上应标明长、宽，并注明面积）",imgs:[]}),t.childs.forEach((function(t,n){t.isSel&&"含网络经营"===t.name&&e.push({name:"符合食品安全要求的产品包装材料证明，以及与经营规模相适应、符合配送要求的设施设备等有关资料（运输车辆、容器等）",imgs:[]}),!t.isSel||"中央厨房"!==t.name&&"集体用餐配送"!==t.name||e.push({name:"关键环节食品加工操作规程、符合食品安全要求的产品包装材料证明、与实际产品内容相符合的标识说明样张、与经营规模相适应、符合配送要求的设施设备等有关资料（运输车辆、容器等）和开展食品及环节表面菌落总数、致病菌检验设施设备清单",imgs:[]})}))):e.push({name:"经营场所、设备布局、加工流程、卫生设施等平面示意图及说明和经营设备或者设施清单（布局示意图上应标明长、宽，并注明面积）",imgs:[]},{name:"关键环节食品加工操作规程",imgs:[]})})),n.projectForm.forEach((function(t,n){t.isSel&&"散装食品销售"===t.name?t.childs.forEach((function(t,n){t.isSel&&"含散装熟食"===t.name&&e.push({name:"与挂钩生产单位的合作协议（合同），生产单位的《食品生产许可证》",imgs:[]})})):t.isSel&&"自制饮品制售"===t.name&&t.childs.forEach((function(t,n){t.isSel&&"含自制生鲜乳饮品"===t.name&&e.push({name:"加工消毒等关键环节操作规程、加工设备、包装材料（容器）的生产合格证明、成品安全性检验合格报告和奶源供货合同及供货商资质等文件",imgs:[]})}))}));var i={};this.form.materialList=e.reduce((function(t,e){return!i[e.name]&&(i[e.name]=t.push(e)),t}),[])},methods:{filterMaterial:function(t){return Array.from(new Set(t))},handleSaveDraft:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(n,i){var r=Object(a["a"])(Object(a["a"])({},t.draftInfo),{},{uploadMaterial:t.form,showTips:e});t.$store.dispatch("draft/saveDraft",r).then((function(){n()})).catch((function(){i()}))}))},updateFileList:function(t){console.log("扫码上传回调：",t);var e=JSON.parse(JSON.stringify(this.form.materialList));e.forEach((function(e,n){+t.type===n&&(e.imgs=e.imgs.concat(t.data))})),console.log(e),this.$set(this.form,"materialList",e)},handleDel:function(t,e){this.form.materialList[t].imgs.splice(e,1)},judgeIsPdf:function(t){var e=t.slice(-3);return"pdf"===e},handlePreview:function(t){console.log("".concat(t)),this.judgeIsPdf(t)?(this.isPdfPreview=!0,this.dialogPdfUrl=this.$utils.getFile(t)):(this.isPicturePreview=!0,this.dialogImageUrl=this.$utils.getFile(t))},handleNext:function(){var t=Object(s["a"])(Object(o["a"])().mark((function t(){var e,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=JSON.parse(JSON.stringify(this.form.materialList)),n=0;case 2:if(!(n<e.length)){t.next=8;break}if(0!==e[n].imgs.length){t.next=5;break}return t.abrupt("return",this.$utils.showError("请完善上传材料信息！"));case 5:n++,t.next=2;break;case 8:return t.next=10,this.handleSaveDraft();case 10:this.$router.push({path:"/form/otherInfo",query:Object(a["a"])({},this.$route.query)});case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},d=l,h=(n("0f04"),n("2877")),p=Object(h["a"])(d,i,r,!1,null,"81be1a9a",null);e["default"]=p.exports},b39a:function(t,e,n){var i=n("d3f4");t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},c26b:function(t,e,n){"use strict";var i=n("86cc").f,r=n("2aeb"),a=n("dcbc"),o=n("9b43"),s=n("f605"),c=n("4a59"),f=n("01f9"),u=n("d53b"),l=n("7a56"),d=n("9e1e"),h=n("67ab").fastKey,p=n("b39a"),v=d?"_s":"size",m=function(t,e){var n,i=h(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,f){var u=t((function(t,i){s(t,u,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=i&&c(i,n,t[f],t)}));return a(u.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=m(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(t){p(this,e);var n,i=o(t,arguments.length>1?arguments[1]:void 0,3);while(n=n?n.n:this._f){i(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function(t){return!!m(p(this,e),t)}}),d&&i(u.prototype,"size",{get:function(){return p(this,e)[v]}}),u},def:function(t,e,n){var i,r,a=m(t,e);return a?a.v=n:(t._l=a={i:r=h(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[v]++,"F"!==r&&(t._i[r]=a)),t},getEntry:m,setStrong:function(t,e,n){f(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){var t=this,e=t._k,n=t._l;while(n&&n.r)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?u(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,u(1))}),n?"entries":"values",!n,!0),l(e)}}},e0b8:function(t,e,n){"use strict";var i=n("7726"),r=n("5ca1"),a=n("2aba"),o=n("dcbc"),s=n("67ab"),c=n("4a59"),f=n("f605"),u=n("d3f4"),l=n("79e5"),d=n("5cc5"),h=n("7f20"),p=n("5dbc");t.exports=function(t,e,n,v,m,b){var g=i[t],_=g,w=m?"set":"add",y=_&&_.prototype,P={},S=function(t){var e=y[t];a(y,t,"delete"==t||"has"==t?function(t){return!(b&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return b&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(b||y.forEach&&!l((function(){(new _).entries().next()})))){var x=new _,k=x[w](b?{}:-0,1)!=x,E=l((function(){x.has(1)})),O=d((function(t){new _(t)})),$=!b&&l((function(){var t=new _,e=5;while(e--)t[w](e,e);return!t.has(-0)}));O||(_=e((function(e,n){f(e,_,t);var i=p(new g,e,_);return void 0!=n&&c(n,m,i[w],i),i})),_.prototype=y,y.constructor=_),(E||$)&&(S("delete"),S("has"),m&&S("get")),($||k)&&S(w),b&&y.clear&&delete y.clear}else _=v.getConstructor(e,t,m,w),o(_.prototype,n),s.NEED=!0;return h(_,t),P[t]=_,r(r.G+r.W+r.F*(_!=g),P),b||v.setStrong(_,t,m),_}},f1ae:function(t,e,n){"use strict";var i=n("86cc"),r=n("4630");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}}}]);