(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03e0880b"],{"2a35":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"utilityForm"},[r("breadcrumb",{directives:[{name:"show",rawName:"v-show",value:"test"!==e.$route.query.mode,expression:"$route.query.mode !== 'test'"}]}),e._v(" "),r("div",{staticClass:"utilityContainer"},[r("div",{staticClass:"utilityHeader"},[e._v("\n      水、气、网信息填报\n    ")]),e._v(" "),r("div",{staticClass:"utilityMain"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"left"}},[e.work.waterRegistList&&e.work.waterRegistList.length>0?[r("el-form-item",{attrs:{label:"水务",prop:"waterRegistAddress","label-width":"80px"}},[r("el-row",[r("el-radio-group",{model:{value:e.form.waterRegistAddress,callback:function(t){e.$set(e.form,"waterRegistAddress",t)},expression:"form.waterRegistAddress"}},e._l(e.work.waterRegistList,(function(t,a){return r("el-col",{key:a,attrs:{span:e.work.waterRegistList.length<4?24/e.work.waterRegistList.length:6}},[r("el-radio",{attrs:{label:t.outletsName}},[e._v(e._s(t.outletsName))])],1)})),1)],1)],1)]:e._e(),e._v(" "),e.work.naturalGasRegistList&&e.work.naturalGasRegistList.length>0?[r("el-form-item",{attrs:{label:"天然气",prop:"naturalGasRegistAddress","label-width":"80px"}},[r("el-row",[r("el-radio-group",{model:{value:e.form.naturalGasRegistAddress,callback:function(t){e.$set(e.form,"naturalGasRegistAddress",t)},expression:"form.naturalGasRegistAddress"}},e._l(e.work.naturalGasRegistList,(function(t,a){return r("el-col",{key:a,attrs:{span:e.work.naturalGasRegistList.length<4?24/e.work.naturalGasRegistList.length:6}},[r("el-radio",{attrs:{label:t.outletsName}},[e._v(e._s(t.outletsName))])],1)})),1)],1)],1)]:e._e(),e._v(" "),e.work.internetRegistList&&e.work.internetRegistList.length>0?[r("el-form-item",{attrs:{label:"网络",prop:"internetRegistAddress","label-width":"80px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-checkbox-group",{model:{value:e.form.internetRegistAddress,callback:function(t){e.$set(e.form,"internetRegistAddress",t)},expression:"form.internetRegistAddress"}},e._l(e.work.internetRegistList,(function(t,a){return r("el-checkbox",{key:a,attrs:{label:t.outletsName}},[e._v(e._s(t.outletsName))])})),1)],1)],1)],1)]:e._e(),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),e.businessShow.dlchecked||e.businessShow.waterchecked||e.businessShow.rqchecked?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],2)],1)])],1)},s=[],i=r("5530"),n=r("c7eb"),o=(r("28a5"),r("96cf"),r("1da1")),u=r("6350"),c=r("365c"),l={components:{Breadcrumb:u["a"]},data:function(){return{baseInfo:{},curArea:{},companyType:"",type:"",work:{},form:{internetRegistAddress:[],naturalGasRegistAddress:"",waterRegistAddress:"",gasType:"",gasNature:"",gasDemand:"",waterType:"",waterDemand:"",waterMm:"",waterNature:"",internetMb:"",telePhoneCount:"",internetAddress:""},rules:{waterRegistAddress:[{required:!0,message:"请至少选择一个水务单位",trigger:"change"}],naturalGasRegistAddress:[{required:!0,message:"请至少选择一个天然气单位",trigger:"change"}],internetRegistAddress:[{type:"array",required:!0,message:"请至少选择一个网络",trigger:"change"}],gasType:[{required:!0,message:"请选择",trigger:"change"}],gasDemand:[{required:!0,message:"请选择",trigger:"change"}],gasNature:[{required:!0,message:"请选择",trigger:"change"}],waterMm:[{required:!0,message:"请输入",trigger:"change"}],waterDemand:[{required:!0,message:"请选择",trigger:"change"}],waterType:[{required:!0,message:"请选择",trigger:"change"}],waterNature:[{required:!0,message:"请输入",trigger:"change"}],internetMb:[{required:!0,message:"请输入",trigger:"change"}],telePhoneCount:[{required:!0,message:"请输入",trigger:"change"}],internetAddress:[{required:!0,message:"请输入",trigger:"change"}]}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo},businessShow:function(){return this.$utils.getItem("businessShow")},waterLectricityEtwork:function(){return this.$utils.getItem("waterLectricityEtwork")}},created:function(){var e=this,t=null;t=this.$utils.getItem("nameApply").areaCode,console.log(t,"areacode"),Object(c["kb"])({areacode:t,waterLectricityEtwork:{isWaterRegist:this.waterLectricityEtwork.isWaterRegist?1:0,isNaturalGasRegist:this.waterLectricityEtwork.isNaturalGasRegist?1:0,isInternetRegist:this.waterLectricityEtwork.isInternetRegist?1:0}}).then((function(t){e.work=t.data}))},activated:function(){var e=this;this.type=this.$route.query.type,this.$utils.getLocalItem("baseInfo")&&(this.baseInfo=this.$utils.getLocalItem("baseInfo")),this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea")),this.getAreaInfo().then(Object(o["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$utils.getItem("draftNumber")&&e.$store.dispatch("draft/getDraftDetail",e.$utils.getItem("draftNumber")).then(function(){var t=Object(o["a"])(Object(n["a"])().mark((function t(r){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.waterLectricityEtwork&&(a=r.waterLectricityEtwork,e.form=a,e.form.internetRegistAddress=e.form.internetRegistAddress.length>0?e.form.internetRegistAddress.split(","):[]);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))))},methods:{clearValidate:function(){this.$refs["form"].clearValidate()},handleSaveDraft:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,a){var s=Object(i["a"])(Object(i["a"])({},e.draftInfo),{},{waterLectricityEtwork:e.waterLectricityEtwork,businessType:"2",showTips:t});e.$store.dispatch("draft/saveDraft",s).then((function(){r()})).catch((function(){a()}))}))},getAreaInfo:function(){var e=this;return new Promise((function(t){var r={inData:{},job:"HuBei_DistCode"};e.$utils.showLoading(),e.$api.startJob(r).then(function(){var r=Object(o["a"])(Object(n["a"])().mark((function r(a){var s,i,o,u;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:s=e.curArea.areaCode,i=e.curArea.areaLabel,o=e.$utils.getItem("area"),u=a.outData.data.filter((function(t){return t.label.trim()===e.curArea.city})),u[0].children=u[0].children.filter((function(e){return e.label.trim()===o.label.trim()})),e.areaList=[{value:"420000",label:"湖北省",children:u}],s.push(o.code),e.form.areaArr=s,i.push(o.label),e.form.accountOpenArea=i.join(" "),e.form.addressAreaCode=s[2],e.$utils.hideLoading(),t();case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))},handleNext:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(o["a"])(Object(n["a"])().mark((function t(r){var a,s,o,u,l,d;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=32;break}return console.log(e.form),0===+e.form.internetRegistAddress.length&&(e.form.internetRegistAddress=["中国电信","中国移动","中国联通"]),e.waterLectricityEtwork.naturalGasRegistAddress=e.form.naturalGasRegistAddress,e.waterLectricityEtwork.waterRegistAddress=e.form.waterRegistAddress,e.waterLectricityEtwork.internetRegistAddress=e.form.internetRegistAddress.join(","),e.waterLectricityEtwork.outlets=e.form.internetRegistAddress.join(","),t.next=9,e.handleSaveDraft();case 9:if(e.$utils.setItem("waterLectricityEtwork",e.waterLectricityEtwork),!e.businessShow.waterchecked){t.next=13;break}return e.$router.push({path:"/form/waterRegister",query:Object(i["a"])({},e.$route.query)}),t.abrupt("return");case 13:if(!e.businessShow.dlchecked){t.next=16;break}return e.$router.push({path:"/form/electricityAllowed",query:Object(i["a"])({},e.$route.query)}),t.abrupt("return");case 16:if(!e.businessShow.rqchecked){t.next=19;break}return e.$router.push({path:"/form/gasRegister",query:Object(i["a"])({},e.$route.query)}),t.abrupt("return");case 19:console.log("waterLectricityEtwork",e.waterLectricityEtwork),console.log("draftInfo",e.draftInfo),a=e.draftInfo.nameApply,s=e.draftInfo.address,o=e.draftInfo.scope,u=e.draftInfo.member,l=e.draftInfo.otherInfo||e.$utils.getItem("otherInfo"),d=Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({},a),s),{},{scope:o},u),l),{},{industryType:{IndustryCode:a.industryFormulated.split("-")[0],IndustryName:a.industryFormulated.split("-")[2]},industryFormulated:a.industryFormulated.split("-")[1],area:a.area.join(" ")}),console.log(d),e.$loading({text:"正在获取pdf内容"}),Object(c["Y"])(d,e.$route.query.whatfrom).then((function(t){if(e.$loading().close(),500===+t.errCode||"faulted"===t.state)return e.$utils.showError("生成失败，请重试！");e.$router.push({path:"/form/preview",query:Object(i["a"])(Object(i["a"])({},e.$route.query),{},{path:t.outData.pdf})})})),t.next=33;break;case 32:e.$utils.showError("请按提示信息补充完整表单！");case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=l,g=(r("a242"),r("2877")),f=Object(g["a"])(d,a,s,!1,null,"15f97fbb",null);t["default"]=f.exports},5557:function(e,t,r){},a242:function(e,t,r){"use strict";r("5557")}}]);