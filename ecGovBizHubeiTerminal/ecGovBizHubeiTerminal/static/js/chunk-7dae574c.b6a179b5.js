(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dae574c"],{1133:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"address-form"},[r("breadcrumb",{directives:[{name:"show",rawName:"v-show",value:"test"!==e.$route.query.mode,expression:"$route.query.mode !== 'test'"}]}),e._v(" "),r("div",{staticClass:"box"},[r("div",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),r("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{staticClass:"radio",attrs:{label:"是否办理银行开户",prop:"isOpenBankAccount","label-width":"274px"}},[r("el-radio-group",{attrs:{disabled:""},model:{value:e.form.isOpenBankAccount,callback:function(t){e.$set(e.form,"isOpenBankAccount",t)},expression:"form.isOpenBankAccount"}},[r("el-radio",{attrs:{label:!0,border:""},on:{change:e.clearValidate}},[e._v("是")]),e._v(" "),r("el-radio",{attrs:{label:!1,border:""},on:{change:e.clearValidate}},[e._v("否")])],1)],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"银行开户经办人",prop:"bankAccountManagerType","label-width":"160px"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selectBankManagerType},model:{value:e.form.bankAccountManagerType,callback:function(t){e.$set(e.form,"bankAccountManagerType",t)},expression:"form.bankAccountManagerType"}},e._l(e.bankAccountManagerTypeList,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名",prop:"name","label-width":"120px"}},[r("el-input",{staticStyle:{width:"221px"},attrs:{placeholder:"请填写"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"手机号码",prop:"phone","label-width":"120px"}},[r("el-input",{staticStyle:{width:"221px"},attrs:{maxlength:"11",placeholder:"请填写"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开户所在地",prop:"addressArea","label-width":"120px"}},[r("el-cascader",{ref:"addressArea",attrs:{options:e.areaList,separator:" ",disabled:"",props:{expandTrigger:"hover"},placeholder:"请选择行政区划"},on:{change:function(t){return e.handleChangeArea(t,"addressArea")}},model:{value:e.form.areaArr,callback:function(t){e.$set(e.form,"areaArr",t)},expression:"form.areaArr"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开户银行",prop:"openBank","label-width":"120px"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selectBank},model:{value:e.form.openBank,callback:function(t){e.$set(e.form,"openBank",t)},expression:"form.openBank"}},e._l(e.openBankList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.serviceProvider,value:e.serviceProvider}})})),1)],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"银行网点",prop:"bankBranch","label-width":"120px"}})],1),e._v(" "),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"bank-adress-box"},[r("div",{staticClass:"bank-adress-list"},[r("el-radio-group",{model:{value:e.form.bankBranch,callback:function(t){e.$set(e.form,"bankBranch",t)},expression:"form.bankBranch"}},e._l(e.bankList,(function(t,a){return r("el-radio",{key:a,staticClass:"bank-adress-item",attrs:{label:t.outletsName}},[r("div",{staticClass:"bank-adress-text"},[r("div",{staticStyle:{color:"#000"}},[e._v(e._s(t.outletsName)),r("span",{staticStyle:{"font-size":"14px"}},[e._v("（"+e._s(t.outletsAddr)+"）")])]),e._v(" "),r("div",{staticStyle:{"margin-top":"10px",color:"#999","font-size":"15px"}},[r("span",[e._v("联系人："+e._s(t.outletsContactPerson)+" ")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("联系电话："+e._s(t.outletsPhone))])])])])})),1)],1)])])],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),e.businessShow.gjjchecked||e.businessShow.ylchecked||e.businessShow.sdqwchecked||e.businessShow.dlchecked?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],1)],1)],1)},n=[],o=(r("28a5"),r("5530")),s=r("c7eb"),c=(r("7f7f"),r("ac6a"),r("96cf"),r("1da1")),i=r("6350"),l=r("365c"),u={components:{Breadcrumb:i["a"]},data:function(){return{baseInfo:{},curArea:{},companyType:"",type:"",areaList:[],rules:{isOpenBankAccount:[{required:!0,message:"请选择是否办理银行开户",trigger:"change"}],bankAccountManagerType:[{required:!0,message:"请选择银行开户经办人",trigger:"change"}],name:[{required:!0,message:"请填写名称",trigger:"change"},{pattern:/[\u4e00-\u9fa5]/,message:"请填写中文字符"}],phone:[{required:!0,message:"请填写手机号码",trigger:"change"},{pattern:/^1(?:3\d|4[4-9]|5[0-35-9]|6[67]|7[013-8]|8\d|9\d)\d{8}$/,message:"请填写正确的手机号码"}],openBank:[{required:!0,message:"请选择开户银行",trigger:"change"}],bankBranch:[{required:!0,message:"请选择银行网点",trigger:"change"}]},bankList:[],bankAccountManagerTypeList:["法定代表人","财务负责人","其他"],openBankList:[],form:{isOpenBankAccount:!0,bankAccountManagerType:"法定代表人",name:"",phone:"",accountOpenArea:"",openBank:"",bankBranch:"",addressArea:"",areaArr:[],addressAreaCode:""}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo},businessShow:function(){return this.$utils.getItem("businessShow")}},created:function(){var e=this,t=null;t=this.$utils.getItem("nameApply").areaCode,Object(l["N"])({areacode:t,serviceProvider:"银行"}).then((function(t){e.openBankList=t.data||[],t.data.length&&(e.form.openBank=t.data[0].serviceProvider,e.selectBank(t.data[0].serviceProvider))}))},activated:function(){var e=this;this.type=this.$route.query.type,this.$utils.getLocalItem("baseInfo")&&(this.baseInfo=this.$utils.getLocalItem("baseInfo")),this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea")),this.getAreaInfo().then(Object(c["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$utils.getItem("draftNumber")&&e.$store.dispatch("draft/getDraftDetail",e.$utils.getItem("draftNumber")).then(function(){var t=Object(c["a"])(Object(s["a"])().mark((function t(r){var a,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.bankOpenAccount&&(a=r.bankOpenAccount,e.form=a),r.member&&(n=r.member.memberList,n.length>0&&n.forEach((function(t){t.jobs.forEach((function(r){if("法定代表人"===r.name)return e.form.name=t.idcName,void(e.form.phone=t.phone)}))})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))))},methods:{clearValidate:function(){this.$refs["form"].clearValidate()},handleSaveDraft:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,a){var n=Object(o["a"])(Object(o["a"])({},e.draftInfo),{},{bankOpenAccount:e.form,businessType:"2",showTips:t});e.$store.dispatch("draft/saveDraft",n).then((function(){r()})).catch((function(){a()}))}))},getAreaInfo:function(){var e=this;return new Promise((function(t){var r={inData:{},job:"HuBei_DistCode"};e.$utils.showLoading(),e.$api.startJob(r).then(function(){var r=Object(c["a"])(Object(s["a"])().mark((function r(a){var n,o,c,i;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.curArea.areaCode,o=e.curArea.areaLabel,c=e.$utils.getItem("area"),i=a.outData.data.filter((function(t){return t.label.trim()===e.curArea.city})),i[0].children=i[0].children.filter((function(e){return e.label.trim()===c.label.trim()})),e.areaList=[{value:"420000",label:"湖北省",children:i}],n.push(c.code),e.form.areaArr=n,o.push(c.label),e.form.accountOpenArea=o.join(" "),e.form.addressAreaCode=n[2],e.$utils.hideLoading(),t();case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))},handleChangeArea:function(e,t){this.form["".concat(t,"Code")]=e[2],this.form[t]=this.$refs[t].getCheckedNodes()[0].pathLabels.join(" ")},selectBank:function(e){var t=this;console.log(e),this.openBankList.forEach((function(r){console.log(r),r.serviceProvider===e&&(t.bankList=r.accountList)}))},selectBankManagerType:function(e){var t=this;this.form.name="",this.form.phone="";var r=this.draftInfo.member.memberList;r.length>0&&r.forEach((function(r){r.jobs.forEach((function(a){return"财务负责人"===a.name&&"财务负责人"===e||"法定代表人"===a.name&&"法定代表人"===e?(t.form.name=r.idcName,void(t.form.phone=r.phone)):void 0}))}))},handleNext:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(c["a"])(Object(s["a"])().mark((function t(r){var a,n,c,i,u,d,f;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=35;break}return console.log(e.draftInfo),a=e.draftInfo.nameApply,n=e.draftInfo.address,c=e.draftInfo.scope,i=e.draftInfo.member,u=e.draftInfo.otherInfo,d=Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},a),n),{},{scope:c},i),u),{},{industryType:{IndustryCode:a.industryFormulated.split("-")[0],IndustryName:a.industryFormulated.split("-")[2]},industryFormulated:a.industryFormulated.split("-")[1],area:a.area.join(" ")}),console.log(d),t.next=11,e.handleSaveDraft();case 11:if(e.$utils.setItem("bankOpenAccount",e.form),f=e.businessShow,!f.gjjchecked){t.next=16;break}return e.$router.push({path:"/form/accumulationFund",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 16:if(!f.ylchecked){t.next=19;break}return e.$router.push({path:"/form/medicalInsurance",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 19:if(!f.sdqwchecked){t.next=22;break}return e.$router.push({path:"/form/utilityForm",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 22:if(!f.waterchecked){t.next=25;break}return e.$router.push({path:"/form/waterRegister",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 25:if(!f.dlchecked){t.next=28;break}return e.$router.push({path:"/form/electricityAllowed",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 28:if(!f.rqchecked){t.next=31;break}return e.$router.push({path:"/form/gasRegister",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 31:e.$loading({text:"正在获取pdf内容"}),Object(l["Y"])(d,e.$route.query.whatfrom).then((function(t){if(e.$loading().close(),500===+t.errCode||"faulted"===t.state)return e.$utils.showError("生成失败，请重试！");e.$router.push({path:"/form/preview",query:Object(o["a"])(Object(o["a"])({},e.$route.query),{},{path:t.outData.pdf})})})),t.next=36;break;case 35:e.$utils.showError("请按提示信息补充完整表单！");case 36:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=u,f=(r("4e19"),r("2877")),p=Object(f["a"])(d,a,n,!1,null,"d00ba8ec",null);t["default"]=p.exports},"4e19":function(e,t,r){"use strict";r("b38b")},"7f7f":function(e,t,r){var a=r("86cc").f,n=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in n||r("9e1e")&&a(n,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},b38b:function(e,t,r){}}]);