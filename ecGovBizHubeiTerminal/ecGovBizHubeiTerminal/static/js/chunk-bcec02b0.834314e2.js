(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bcec02b0"],{"1d68":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"address-form"},[r("breadcrumb",{directives:[{name:"show",rawName:"v-show",value:"test"!==e.$route.query.mode,expression:"$route.query.mode !== 'test'"}]}),e._v(" "),r("div",{staticClass:"box"},[r("div",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),r("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"业务类型",prop:"businessType","label-width":"140px"}},[r("el-radio-group",{model:{value:e.form.businessType,callback:function(t){e.$set(e.form,"businessType",t)},expression:"form.businessType"}},[r("el-radio-button",{attrs:{label:"新开户"}}),e._v(" "),r("el-radio-button",{attrs:{label:"扩容"}}),e._v(" "),r("el-radio-button",{attrs:{label:"临时用水"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否需要双路供水",prop:"isTwoWaterSupply","label-width":"160px"}},[r("el-radio-group",{model:{value:e.form.isTwoWaterSupply,callback:function(t){e.$set(e.form,"isTwoWaterSupply",t)},expression:"form.isTwoWaterSupply"}},[r("el-radio-button",{attrs:{label:"是"}}),e._v(" "),r("el-radio-button",{attrs:{label:"否"}})],1)],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"供水需求",prop:"waterDemand","label-width":"140px"}},[r("el-input",{staticStyle:{width:"221px"},attrs:{placeholder:"请填写"},model:{value:e.form.waterDemand,callback:function(t){e.$set(e.form,"waterDemand",t)},expression:"form.waterDemand"}}),e._v(" 吨/日\n          ")],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"预约时间",prop:"reserveTime","label-width":"140px"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期时间","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.form.reserveTime,callback:function(t){e.$set(e.form,"reserveTime",t)},expression:"form.reserveTime"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"网点",prop:"outlets","label-width":"120px"}},[r("div",{staticClass:"seal-adress-box"},[r("div",{staticClass:"seal-adress-list"},[r("el-radio-group",{model:{value:e.form.outlets,callback:function(t){e.$set(e.form,"outlets",t)},expression:"form.outlets"}},e._l(e.outletsList,(function(t,a){return r("el-radio",{key:a,staticClass:"seal-adress-item",attrs:{label:t.outletsName}},[r("div",{staticClass:"seal-adress-text"},[r("div",{staticStyle:{color:"#000"}},[e._v(e._s(t.outletsName)),r("span",{staticStyle:{"font-size":"14px"}},[e._v("（"+e._s(t.outletsAddr)+"）")])]),e._v(" "),r("div",{staticStyle:{"margin-top":"10px",color:"#999","font-size":"15px"}},[r("span",[e._v("联系人："+e._s(t.outletsContactPerson)+" ")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("联系电话："+e._s(t.outletsPhone))])])])])})),1)],1)])])],1)],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),e.businessShow.dlchecked||e.businessShow.rqchecked?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],1)],1)],1)},s=[],o=(r("28a5"),r("5530")),i=r("c7eb"),n=(r("96cf"),r("1da1")),l=r("6350"),u=r("365c"),c={components:{Breadcrumb:l["a"]},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},baseInfo:{},curArea:{},type:"",rules:{businessType:[{required:!0,message:"请选择业务类型",trigger:"change"}],isTwoWaterSupply:[{required:!0,message:"请选择是否需要双路供水",trigger:"change"}],waterDemand:[{required:!0,message:"请填写供水需求",trigger:"blur"},{pattern:/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/,message:"请填写大于零的小数或整数"}],reserveTime:[{required:!0,message:"请选择预约时间",trigger:"change"}],outlets:[{required:!0,message:"请选择网点",trigger:"change"}]},outletsList:[],form:{outlets:"",businessType:"",isTwoWaterSupply:"",waterDemand:"",reserveTime:""}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo},water:function(){return this.$utils.getItem("water")},businessShow:function(){return this.$utils.getItem("businessShow")}},created:function(){var e=this,t=null;t=this.$utils.getItem("nameApply").areaCode,Object(u["N"])({areacode:t,serviceProvider:"水务"}).then((function(t){e.outletsList=t.data||[]}))},activated:function(){var e=this;this.type=this.$route.query.type,this.$utils.getLocalItem("baseInfo")&&(this.baseInfo=this.$utils.getLocalItem("baseInfo")),this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea")),this.$utils.getItem("draftNumber")&&this.$store.dispatch("draft/getDraftDetail",this.$utils.getItem("draftNumber")).then(function(){var t=Object(n["a"])(Object(i["a"])().mark((function t(r){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.water&&(a=r.water,e.form=a);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{clearValidate:function(){this.$refs["form"].clearValidate()},handleSaveDraft:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,a){var s=Object(o["a"])(Object(o["a"])({},e.draftInfo),{},{water:e.form,businessType:"2",showTips:t});e.$store.dispatch("draft/saveDraft",s).then((function(){r()})).catch((function(){a()}))}))},handleNext:function(){var e=this;console.log(this.form),this.$refs["form"].validate(function(){var t=Object(n["a"])(Object(i["a"])().mark((function t(r){var a,s,n,l,c,d;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=21;break}return t.next=3,e.handleSaveDraft();case 3:if(e.$utils.setItem("water",e.form),!e.businessShow.dlchecked){t.next=7;break}return e.$router.push({path:"/form/electricityAllowed",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 7:if(!e.businessShow.rqchecked){t.next=10;break}return e.$router.push({path:"/form/gasRegister",query:Object(o["a"])({},e.$route.query)}),t.abrupt("return");case 10:a=e.draftInfo.nameApply,s=e.draftInfo.address,n=e.draftInfo.scope,l=e.draftInfo.member,c=e.draftInfo.otherInfo,d=Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},a),s),{},{scope:n},l),c),{},{industryType:{IndustryCode:a.industryFormulated.split("-")[0],IndustryName:a.industryFormulated.split("-")[2]},industryFormulated:a.industryFormulated.split("-")[1],area:a.area.join(" ")}),console.log(d),e.$loading({text:"正在获取pdf内容"}),Object(u["Y"])(d,e.$route.query.whatfrom).then((function(t){if(e.$loading().close(),500===+t.errCode||"faulted"===t.state)return e.$utils.showError("生成失败，请重试！");e.$router.push({path:"/form/preview",query:Object(o["a"])(Object(o["a"])({},e.$route.query),{},{path:t.outData.pdf})})})),t.next=22;break;case 21:e.$utils.showError("请按提示信息补充完整表单！");case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=c,f=(r("ff1f"),r("2877")),p=Object(f["a"])(d,a,s,!1,null,"f588c314",null);t["default"]=p.exports},"6b96":function(e,t,r){},ff1f:function(e,t,r){"use strict";r("6b96")}}]);