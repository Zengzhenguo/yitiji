(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef9d623c"],{"47bf":function(e,t,r){"use strict";r("4baa")},"4baa":function(e,t,r){},"7f87":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"address-form"},[r("breadcrumb",{directives:[{name:"show",rawName:"v-show",value:"test"!==e.$route.query.mode,expression:"$route.query.mode !== 'test'"}]}),e._v(" "),r("div",{staticClass:"box"},[r("div",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),"9210commercial"===e.$route.query.type?r("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"报装类型",prop:"newspaperType","label-width":"140px"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.newspaperType,callback:function(t){e.$set(e.form,"newspaperType",t)},expression:"form.newspaperType"}},e._l(e.newspaperTypeList,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"申请容量",prop:"applyCapacity","label-width":"140px"}},[r("el-input",{staticStyle:{width:"221px"},attrs:{placeholder:"请填写"},model:{value:e.form.applyCapacity,callback:function(t){e.$set(e.form,"applyCapacity",t)},expression:"form.applyCapacity"}}),e._v(" kVA\n          ")],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产权文件证明",prop:"propertyDoc","label-width":"140px"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.propertyDoc,callback:function(t){e.$set(e.form,"propertyDoc",t)},expression:"form.propertyDoc"}},e._l(e.propertyDocList,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"",prop:"pictureUrl","label-width":"140px"}},[e.form.pictureUrl?r("img",{staticClass:"picture-img",attrs:{src:e.$utils.getFile(e.form.pictureUrl),alt:""}}):e._e(),e._v(" "),r("upload-code",{attrs:{placement:"bottom-start",alias:"pictureUrl"},on:{update:e.updateFileList}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"网点",prop:"outlets","label-width":"120px"}})],1),e._v(" "),r("el-col",{attrs:{span:20}},[r("div",{staticClass:"seal-adress-box"},[r("div",{staticClass:"seal-adress-list"},[r("el-radio-group",{model:{value:e.form.outlets,callback:function(t){e.$set(e.form,"outlets",t)},expression:"form.outlets"}},e._l(e.outletsList,(function(t,a){return r("el-radio",{key:a,staticClass:"seal-adress-item",attrs:{label:t.outletsName}},[r("div",{staticClass:"seal-adress-text"},[r("div",{staticStyle:{color:"#000"}},[e._v(e._s(t.outletsName)),r("span",{staticStyle:{"font-size":"14px"}},[e._v("（"+e._s(t.outletsAddr)+"）")])]),e._v(" "),r("div",{staticStyle:{"margin-top":"10px",color:"#999","font-size":"15px"}},[r("span",[e._v("联系人："+e._s(t.outletsContactPerson)+" ")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("联系电话："+e._s(t.outletsPhone))])])])])})),1)],1)])])],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),e.businessShow.rqchecked?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],1):e._e(),e._v(" "),"commercial"===e.$route.query.type||"commercialRegister"===e.$route.query.type?r("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"业务类型",prop:"newspaperType","label-width":"120px"}},[r("el-radio-group",{model:{value:e.form.newspaperType,callback:function(t){e.$set(e.form,"newspaperType",t)},expression:"form.newspaperType"}},[r("el-radio-button",{attrs:{label:"新装"}}),e._v(" "),r("el-radio-button",{attrs:{label:"增容"}}),e._v(" "),r("el-radio-button",{attrs:{label:"临时用电"}})],1)],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"主供容量",prop:"mainSupplyCapacity","label-width":"120px"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请填写"},model:{value:e.form.mainSupplyCapacity,callback:function(t){e.$set(e.form,"mainSupplyCapacity",t)},expression:"form.mainSupplyCapacity"}}),e._v(" 千伏安（千瓦）\n          ")],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"备供容量",prop:"reserveCapacity","label-width":"120px"}},[r("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请填写"},model:{value:e.form.reserveCapacity,callback:function(t){e.$set(e.form,"reserveCapacity",t)},expression:"form.reserveCapacity"}}),e._v(" 千伏安（千瓦）\n          ")],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"预约时间",prop:"reserveTime","label-width":"120px"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期时间","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.form.reserveTime,callback:function(t){e.$set(e.form,"reserveTime",t)},expression:"form.reserveTime"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"网点",prop:"outlets","label-width":"120px"}},[r("div",{staticClass:"seal-adress-box"},[r("div",{staticClass:"seal-adress-list"},[r("el-radio-group",{model:{value:e.form.outlets,callback:function(t){e.$set(e.form,"outlets",t)},expression:"form.outlets"}},e._l(e.outletsList,(function(t,a){return r("el-radio",{key:a,staticClass:"seal-adress-item",attrs:{label:t.outletsName}},[r("div",{staticClass:"seal-adress-text"},[r("div",{staticStyle:{color:"#000"}},[e._v(e._s(t.outletsName)),r("span",{staticStyle:{"font-size":"14px"}},[e._v("（"+e._s(t.outletsAddr)+"）")])]),e._v(" "),r("div",{staticStyle:{"margin-top":"10px",color:"#999","font-size":"15px"}},[r("span",[e._v("联系人："+e._s(t.outletsContactPerson)+" ")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("联系电话："+e._s(t.outletsPhone))])])])])})),1)],1)])])],1)],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),e.businessShow.rqchecked?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步")]):r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],1):e._e()],1)],1)},s=[],l=(r("28a5"),r("5530")),o=r("c7eb"),i=(r("96cf"),r("1da1")),n=r("6350"),c=r("365c"),p=r("81f7"),u={components:{Breadcrumb:n["a"],UploadCode:p["a"]},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},baseInfo:{},curArea:{},type:"",rules:{newspaperType:[{required:!0,message:"请选择报装类型",trigger:"change"}],applyCapacity:[{required:!0,message:"请填写申请容量",trigger:"blur"},{pattern:/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/,message:"请填写大于零的小数或整数"}],mainSupplyCapacity:[{required:!0,message:"请填写主供容量",trigger:"blur"},{pattern:/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/,message:"请填写大于零的小数或整数"}],reserveCapacity:[{required:!0,message:"请填写备供容量",trigger:"blur"},{pattern:/^(?!(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/,message:"请填写大于零的小数或整数"}],reserveTime:[{required:!0,message:"请选择预约时间",trigger:"change"}],propertyDoc:[{required:!0,message:"请选择产权文件证明类型",trigger:"change"}],pictureUrl:[{required:!0,message:"请上传产权文件证明",trigger:"change"}],outlets:[{required:!0,message:"请选择网点",trigger:"change"}]},newspaperTypeList:["高压新装","低压非居民新装"],propertyDocList:["产权证","国有土地使用证","集体土地使用证","购房合同","法律文书","产权合法证明"],outletsList:[],form:{newspaperType:"",applyCapacity:"",propertyDoc:"",pictureUrl:"",outlets:"",mainSupplyCapacity:"",reserveCapacity:"",reserveTime:""}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo},businessShow:function(){return this.$utils.getItem("businessShow")}},created:function(){var e=this,t=null;t=this.$utils.getItem("nameApply").areaCode,Object(c["N"])({areacode:t,serviceProvider:"电力"}).then((function(t){e.outletsList=t.data||[]}))},activated:function(){var e=this;this.type=this.$route.query.type,this.$utils.getLocalItem("baseInfo")&&(this.baseInfo=this.$utils.getLocalItem("baseInfo")),this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea")),this.$utils.getItem("draftNumber")&&this.$store.dispatch("draft/getDraftDetail",this.$utils.getItem("draftNumber")).then(function(){var t=Object(i["a"])(Object(o["a"])().mark((function t(r){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.electricity&&(a=r.electricity,e.form=a);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{clearValidate:function(){this.$refs["form"].clearValidate()},updateFileList:function(e){console.log("扫码上传回调：",e),this.form.pictureUrl=e.data[0]},handleSaveDraft:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,a){var s=Object(l["a"])(Object(l["a"])({},e.draftInfo),{},{electricity:e.form,businessType:"2",showTips:t});e.$store.dispatch("draft/saveDraft",s).then((function(){r()})).catch((function(){a()}))}))},handleNext:function(){var e=this;console.log(this.form),this.$refs["form"].validate(function(){var t=Object(i["a"])(Object(o["a"])().mark((function t(r){var a,s,i,n,p,u;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=18;break}return t.next=3,e.handleSaveDraft();case 3:if(e.$utils.setItem("electricity",e.form),!e.businessShow.rqchecked){t.next=7;break}return e.$router.push({path:"/form/gasRegister",query:Object(l["a"])({},e.$route.query)}),t.abrupt("return");case 7:a=e.draftInfo.nameApply,s=e.draftInfo.address,i=e.draftInfo.scope,n=e.draftInfo.member,p=e.draftInfo.otherInfo,u=Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},a),s),{},{scope:i},n),p),{},{industryType:{IndustryCode:a.industryFormulated.split("-")[0],IndustryName:a.industryFormulated.split("-")[2]},industryFormulated:a.industryFormulated.split("-")[1],area:a.area.join(" ")}),console.log(u),e.$loading({text:"正在获取pdf内容"}),Object(c["Y"])(u,e.$route.query.whatfrom).then((function(t){if(e.$loading().close(),500===+t.errCode||"faulted"===t.state)return e.$utils.showError("生成失败，请重试！");e.$router.push({path:"/form/preview",query:Object(l["a"])(Object(l["a"])({},e.$route.query),{},{path:t.outData.pdf})})})),t.next=19;break;case 18:e.$utils.showError("请按提示信息补充完整表单！");case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},m=u,f=(r("47bf"),r("2877")),d=Object(f["a"])(m,a,s,!1,null,"1135ee1e",null);t["default"]=d.exports}}]);