(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de6fd3b6"],{"4a10":function(e,t,a){"use strict";var r=a("5c1a"),o=a.n(r),n="MIICpDCCAYygAwIBAgIQN2xznCyPSWe/5PCdX0IIETANBgkqhkiG9w0BAQsFADAOMQwwCgYDVQQLDANHNGIwHhcNMTgwNDI0MDgzOTQ4WhcNMTgwNTExMDkyMDE2WjAOMQwwCgYDVQQLDANHNGIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCwxZuQ6CZk9gCs09bpk5O8iV/3yn6+dxsWhCIM5ez424TkxL6hhVXreXh9vNMDyduxhxm6DnNq5DETl3eN7VnXTcBy5DO8p99ynPR28yyFysUTQSeTkLnmcjVeVkKLGPiFoD4lh9Uk8OMVVDnFtqK21RS3V9qu09DqyLzgnMJQUgqX5/0niSBxxP7S27QvNaHJmNYHxhfx7B72L58Oq8UwFB+QRPyFgujSANdRP6pcLsZpc303Ra069uHNPUOVjzG/3sdyei4QbvH6iv5LhTLyNOXu3+olCPkRndn/aBeXDX3M6OAChSABeJ6zLrSYz0quUrkzMYD3TxvURhQPASnnAgMBAAEwDQYJKoZIhvcNAQELBQADggEBACfiY+gwI2nGt+ZipqDHmL4jLzvnUmKU+Zn6GCi3t4uIskoqtCK4cCxEgJ8FaOOk8xxJaxrdNwNQQbyYVRYgBfxWbcMCq6wasG92RvpxxQgl3olrTm6N+ELVCZ5iRI3gBlyIX/O0Twb28nWULGh0kPomVFargRPc3H+PUzboAfo7QXqASNXntGH0gre2xqEGnSl385Cbl7Qw6GtxU0UzAhJdnox142GZDBv6G+HN6NX7wqV2o+Sp61MVoY4m/M7/TvEl2zSEJAG2mmfGXwvetFCHM2E8kQvOKLMzwHcLnK16eyCQsy/auO6vK8JLdXswzHKRc+9Q1IMmmsXTxEa3Ugc=",s="-----BEGIN CERTIFICATE-----\r\n".concat(n,"\r\n-----END CERTIFICATE-----\r\n");function i(e){var t=o.a.md.md5.create();return t.update(e),t.digest().toHex()}function c(e,t,a){a="-----BEGIN PKCS7-----"+a+"-----END PKCS7-----";var r=o.a.pkcs7.messageFromPem(a),n=r.findRecipient(e);return r.decrypt(n,t),r.content}function l(e){var t=o.a.pki.certificateFromPem(s),a=o.a.pkcs7.createEnvelopedData();a.addRecipient(t),a.content=o.a.util.createBuffer(e,"utf8"),a.encrypt(null,o.a.pki.oids["des-EDE3-CBC"]);var r=o.a.pkcs7.messageToPem(a);return r}function g(){var e=o.a.pki.rsa.generateKeyPair(1024);return{pub:e.publicKey,pri:e.privateKey}}function u(e,t){var a=o.a.pki.createCertificate();a.privateKey=e,a.publicKey=t,a.validity.notBefore=new Date,a.validity.notAfter=new Date,a.validity.notAfter.setFullYear(a.validity.notBefore.getFullYear()+1);var r=[{name:"organizationName",value:"OU=G4B"}];return a.setSubject(r),a.setIssuer(r),a.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0},{name:"subjectAltName",altNames:[{type:6,value:"http://example.org/webid#me"},{type:7,ip:"127.0.0.1"}]},{name:"subjectKeyIdentifier"}]),a.sign(e),a}t["a"]={forge:o.a,md5:i,envelopeDecrypt:c,envelopeEncrypt:l,createKeypair:g,createCert:u}},5713:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"list-page"},[r("div",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),e._m(0),e._v(" "),r("el-form",{ref:"form",staticClass:"w-1000 form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"企业名称",prop:"companyName"}},[r("el-input",{attrs:{placeholder:"请输入要查询的企业名称"},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"统一社会信用代码",prop:"creditCode","label-width":"184px"}},[r("el-input",{attrs:{placeholder:"企业的统一社会信用代码",maxlength:"20"},model:{value:e.form.creditCode,callback:function(t){e.$set(e.form,"creditCode",t)},expression:"form.creditCode"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"法定代表人",prop:"legalPerson","label-width":"220px"}},[r("el-input",{attrs:{placeholder:"请输入法定代表人",disabled:""},model:{value:e.form.legalPerson,callback:function(t){e.$set(e.form,"legalPerson",t)},expression:"form.legalPerson"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"证件号码",prop:"legalPersonCerNo"}},[r("el-input",{attrs:{placeholder:"请输入证件号码",disabled:"法定代表人"===e.form.role,maxlength:"18"},model:{value:e.form.legalPersonCerNo,callback:function(t){e.$set(e.form,"legalPersonCerNo",t)},expression:"form.legalPersonCerNo"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所属机构",prop:"regorg"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择所属机构"},model:{value:e.form.regorg,callback:function(t){e.$set(e.form,"regorg",t)},expression:"form.regorg"}},e._l(e.orgList,(function(e){return r("el-option",{key:e.code,attrs:{value:e.code,label:e.name}})})),1)],1)],1)],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),r("el-button",{on:{click:e.handleSearch}},[e._v("查询")])],1)],1),e._v(" "),r("el-dialog",{attrs:{visible:e.qrcodeDialog,width:"598px","close-on-click-modal":"","close-on-press-escape":"","show-close":!1},on:{"update:visible":function(t){e.qrcodeDialog=t}}},[r("div",{staticClass:"dialog-qrcode text-center"},[r("div",{staticClass:"dialog-title"},[e._v("请法定代表人/主要经营者，搜索“湖北市场监督融平台”微信小程序，或扫描下方二维码，找到授权委托申请，完成电子签名")]),e._v(" "),r("img",{attrs:{src:a("e58b"),alt:""}}),e._v(" "),r("el-button",{staticClass:"auth-btn",on:{click:function(t){e.qrcodeDialog=!1}}},[e._v("完成授权")])],1)]),e._v(" "),r("el-dialog",{staticClass:"sign_dialog",attrs:{visible:e.dialogSign,width:"500px","close-on-click-modal":"","close-on-press-escape":"","show-close":!0},on:{"update:visible":function(t){e.dialogSign=t}}},[r("div",{staticClass:"dialog_wrap"},[r("img",{staticClass:"ewm",attrs:{src:e.qrcodeImg,alt:""}}),e._v(" "),r("div",{staticStyle:{"font-size":"16px"}},[e._v("请用电子营业执照小程序扫码认证,过程中请不要关掉弹窗")])])])],1)},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tips"},[a("span",[e._v("法定代表人才能查看和打印证照（如不是法定代表人，请使用法定代表人登录）")])])}],n=a("c7eb"),s=(a("96cf"),a("1da1")),i=(a("7f7f"),a("6350")),c=a("b01b"),l=a.n(c),g=a("365c"),u=a("af20"),m=a("9c3e"),d=a.n(m),p=a("b775"),f=a("4a10"),h={components:{Breadcrumb:i["a"],PageHeader:u["a"]},data:function(){var e=this.$utils.validateField;return{orgList:[],printImg:d.a,search:!1,showDialog:!1,qrcodeDialog:!1,dialogSign:!1,signTimer:null,ident:"",type:1,loadingImg:l.a,printData:null,conum:"1",second:0,timer:null,legalPerson:"",form:{role:"",companyName:"",phone:"",legalPerson:"",legalPersonCerNo:"",agentName:"",agentCerNo:"",creditCode:"",promise:!1,regorg:""},rules:{regorg:[{required:!0,message:"请选择所属机构",trigger:"change"}],role:[{required:!0,message:"请选择身份",trigger:"change"}],companyName:[{required:!1,message:"请填写单位名称",trigger:"change"}],creditCode:[{required:!0,message:"请填写企业的统一社会信用代码",trigger:"change"}],legalPerson:[{required:!0,message:"请填写法定代表人姓名",trigger:"change"}],legalPersonCerNo:[{required:!0,message:"请填写法定代表人证件号码",trigger:"change"},{validator:e("id")}]},printList:[],printList1:[{companyName:"咸安区荀彧餐饮店",name:"食品经营许可证",num:1,status:0},{companyName:"咸安区荀彧餐饮店",name:"食品经营许可证(副本)",num:1,status:0}],imgUrl_is:"",imgUrl_vice:"",curArea:{},qrcodeImg:"",qrid:""}},watch:{},created:function(){this.clearTimer(),this.getOrgan();var e=this.$utils.getLocalItem("userInfo");this.form.legalPerson=e.name},mounted:function(){this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea"))},beforeDestroy:function(){this.clearTimer()},methods:{getOrgan:function(){var e=this,t={function:"query_machine_data",arg:{"一体机码":this.$utils.getLocalItem("tId")}};Object(g["M"])(t).then((function(t){e.$loading().close(),"successful"===t.state&&(e.orgList=t.outData.data.行政区划,0!==e.orgList.length&&(e.form.regorg=e.orgList[0].code))}))},hanldePrintImg:function(e){this.$router.push({path:"/printImg",query:{url:e,companyName:this.form.companyName}})},handleChangeType:function(e){var t=this.$utils.getLocalItem("userInfo");"法定代表人"===e?(this.form.agentName="",this.form.agentCerNo="",this.form.legalPerson=t.name,this.form.legalPersonCerNo=t.idNumber):(this.form.legalPerson="",this.form.legalPersonCerNo="",this.form.agentName=t.name,this.form.agentCerNo=t.idNumber)},showQRcode:function(){var e=this,t=f["a"].createKeypair(),a=f["a"].createCert(t.pri,t.pub),r=f["a"].forge.pki.certificateToPem(a),o=JSON.stringify({encCertB64:r,messageHeader:{businesstype:"003",version:"2",sign:"sign"},messageContent:{qrtype:"1101",rettype:"1",qrinfotype:"0",opertime:(new Date).getTime()}}),n=f["a"].envelopeEncrypt(o);p["a"].post("/license/getLicenseElcQrid",{envelope:n}).then((function(r){var o=f["a"].envelopeDecrypt(a,t.pri,r.envelope),n=JSON.parse(o);console.log("获取qrinfo&解密",n),console.log(n.data.message_content),200===n.code?(e.qrcodeImg="data:image/png;base64,"+n.data.message_content.qrimage,e.qrid=n.data.message_content.qrid,e.dialogSign=!0,e.setTimer()):e.$utils.showError(n.message)}))},getLicenseResult:function(){var e=this,t=f["a"].createKeypair(),a=f["a"].createCert(t.pri,t.pub),r=f["a"].forge.pki.certificateToPem(a),o=JSON.stringify({encCertB64:r,messageHeader:{businesstype:"004",version:"2",sign:"sign"},messageContent:{qrtype:"1101",rettype:"1",qrinfotype:"0",opertime:(new Date).getTime(),qrid:this.qrid}});console.log("参数&加密前".concat(o));var n=f["a"].envelopeEncrypt(o);p["a"].post("/license/getLicenseElcResult",{envelope:n}).then((function(r){var o=f["a"].envelopeDecrypt(a,t.pri,r.envelope),n=JSON.parse(o);console.log("获取结果&解密"+JSON.stringify(n)),200===+n.code?n.data.message_content.entname&&("法定代表人"===e.form.role&&(n.data.message_content.entname===e.form.companyName&&n.data.message_content.legalName===e.form.legalPerson&&n.data.message_content.uniscid===e.form.creditCode?(e.clearTimer(),e.searchData()):(e.dialogSign=!1,e.clearTimer(),e.$utils.showError("认证失败"))),"经办人"===e.form.role&&(n.data.message_content.entname===e.form.companyName&&n.data.message_content.legalName===e.form.legalPerson&&n.data.message_content.uniscid===e.form.creditCode&&n.data.message_content.oper===e.form.agentName?(e.clearTimer(),e.searchData()):(e.dialogSign=!1,e.clearTimer(),e.$utils.showError("认证失败")))):e.$utils.showError(n.message)})).catch((function(t){e.$utils.showError(t.message)}))},handleSearch:function(){var e=Object(s["a"])(Object(n["a"])().mark((function e(){var t=this;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs["form"].validate((function(e){if(e){if(t.$loading({text:"查询时间较长，请耐心等待"}),t.searchPerson(),!t.form.companyName&&!t.form.creditCode)return t.$utils.showError("请填写企业名称或者统一社会信息代码")}else t.$utils.showError("请按提示填写必填项")}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),searchPerson:function(){var e=Object(s["a"])(Object(n["a"])().mark((function e(){var t,a,r;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={"一体机码":localStorage.getItem("tId"),regorg:this.form.regorg,uniscid:this.form.creditCode,entname:this.form.companyName},e.next=3,Object(g["v"])(t);case 3:if(a=e.sent,this.$loading().close(),!Array.isArray(a.outData.data)){e.next=15;break}if(this.legalPerson=a.outData.data[0].name,r=this.$utils.getLocalItem("userInfo"),this.legalPerson!==r.name){e.next=12;break}this.searchData(),e.next=13;break;case 12:return e.abrupt("return",this.$utils.showError("当前用户名称与法人名称不一致，请使用法人登录"));case 13:e.next=16;break;case 15:return e.abrupt("return",this.$utils.showError("查询失败，请重试"));case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),searchData:function(){var e=this;this.$loading({text:"查询时间较长，请耐心等待"});var t={"一体机码":localStorage.getItem("tId"),regorg:this.form.regorg,uniscid:this.form.creditCode};Object(g["d"])(t).then((function(t){if(e.$loading().close(),!t.outData.access_token||!t.outData.data)return e.$loading().close(),e.$utils.showError("查询失败，请重试");e.$store.commit("pdfList/SET_PDf_INFO",t.outData),console.log(t.outData,"res"),e.$router.push({path:"/form/previewDocInfoPerson"})}))},setTimer:function(){var e=this;this.timer=setInterval((function(){e.second<300?(e.second++,e.getLicenseResult()):e.clearTimer()}),1e3)},clearTimer:function(){clearInterval(this.timer)}}},y=h,v=(a("ce76"),a("2877")),x=Object(v["a"])(y,r,o,!1,null,"5a46626b",null);t["default"]=x.exports},7:function(e,t){},"7f7f":function(e,t,a){var r=a("86cc").f,o=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in o||a("9e1e")&&r(o,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(e){return""}}})},9797:function(e,t,a){},"9c3e":function(e,t,a){e.exports=a.p+"static/img/xkzImg1.75980075.png"},b01b:function(e,t){e.exports="data:image/png;base64,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"},b3c2:function(e,t,a){e.exports=a.p+"static/img/idCard.437e5e2a.png"},ce76:function(e,t,a){"use strict";a("9797")},e58b:function(e,t,a){e.exports=a.p+"static/img/auth_qrcode.9f556904.png"},ec94:function(e,t,a){e.exports=a.p+"static/img/header_bottom_bg.2a215c97.png"}}]);