(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3104abd0"],{"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n("6b75");function r(t,e){if(t){if("string"==typeof t)return Object(a["a"])(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a["a"])(t,e):void 0}}},"09c9":function(t,e,n){"use strict";n("49b5")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"49b5":function(t,e,n){},5:function(t,e){},6:function(t,e){},"6b75":function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,"a",(function(){return a}))},b802:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"base-form"},[n("breadcrumb"),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"title"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),n("div",{staticClass:"min-title"},[t._v("支持JPG,PNG,PDF")])]),t._v(" "),n("div",{staticClass:"box"},[n("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:t.form,"label-width":"94px"}},[n("el-table",{ref:"materialsTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"span-method":t.spanMethod,border:""}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"parentCategory",label:"类别名称",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"materialName",label:"材料名称",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"上传材料预览",width:"480",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"table-imgBox"},[t._l(e.row.url,(function(a,r){return n("div",{key:r,staticClass:"table-imgLi"},[t.judgeIsPdf(a)?n("div",{staticClass:"pdf",on:{click:function(e){return t.handlePreview(a)}}},[n("pdf",{staticClass:"table-img",staticStyle:{overflow:"hidden"},attrs:{src:t.baseUrl+a}})],1):n("img",{staticClass:"table-img",attrs:{src:t.$utils.getFile(a)},on:{click:function(e){return t.handlePreview(a)}}}),t._v(" "),n("span",{staticClass:"table-imgSpan",on:{click:function(n){return t.handleDel(e.$index,r)}}},[t._v("删除")])])})),t._v(" "),0===e.row.url.length?n("div",{staticStyle:{color:"red"}},[t._v("请上传对应的材料")]):t._e()],2)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("upload-code",{attrs:{placement:"bottom-start",alias:e.$index},on:{update:t.updateFileList}})]}}])})],1),t._v(" "),n("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[n("el-button",{on:{click:function(e){return t.handleSaveDraft(!0)}}},[t._v("暂存草稿")]),t._v(" "),n("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("上一步")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.handleNext}},[t._v("提交申请")])],1)],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.PDF.isOpen,width:"60%"},on:{"update:visible":function(e){return t.$set(t.PDF,"isOpen",e)}}},[n("embed",{staticStyle:{overflow:"hidden",width:"100%",height:"500px"},attrs:{src:t.PDF.url,type:"application/pdf"}})])],1)},r=[],i=(n("a481"),n("5530")),o=(n("ac6a"),n("b85c")),l=n("c7eb"),s=(n("96cf"),n("1da1")),u=n("81f7"),c=n("6350"),f=n("365c"),d=n("858e"),p={components:{UploadCode:u["a"],Breadcrumb:c["a"],pdf:d["a"]},data:function(){return{newDateOptions:{disabledDate:function(t){return t.getTime()<Date.now()}},tableData:[],baseUrl:window.location.origin+"".concat(this.$utils.getPrefix(),"/open-platform/"),PDF:{isOpen:!1,uploadPdfData:[],url:""},form:{materialList:[]}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo}},created:function(){"简易注销"!==this.$route.query.bizName?this.getBusinessLicenseConfig():this.getMaterialList()},mounted:function(){var t=Object(s["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),activated:function(){this.$utils.getItem("draftNumber")&&this.$store.dispatch("draft/getDraftDetail",this.$utils.getItem("draftNumber")).then(function(){var t=Object(s["a"])(Object(l["a"])().mark((function t(e){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{getBusinessLicenseConfig:function(){var t=this;Object(f["z"])(this.$route.query.minType).then((function(e){console.log(e.data),t.tableData=e.data;var n,a=Object(o["a"])(t.tableData);try{for(a.s();!(n=a.n()).done;){var r=n.value;r["url"]=[]}}catch(i){a.e(i)}finally{a.f()}}))},getMaterialList:function(){var t=[{businessLicenseConfigList:null,category:null,id:null,level:null,materialName:"国家企业信用信息公司系统注销截图",parentCategory:"公司注销材料",parentId:null},{businessLicenseConfigList:null,category:null,id:null,level:null,materialName:"简易注销材料",parentCategory:"公司注销材料",parentId:null},{businessLicenseConfigList:null,category:null,id:null,level:null,materialName:"简易注销申请表",parentCategory:"公司注销材料",parentId:null}];this.tableData=t;var e,n=Object(o["a"])(this.tableData);try{for(n.s();!(e=n.n()).done;){var a=e.value;a["url"]=[]}}catch(r){n.e(r)}finally{n.f()}},spanMethod:function(t){var e=t.row,n=t.column,a=t.rowIndex,r=t.columnIndex,i=this;function o(t,e,n,a){var r=i.formatRowspanAndColspan(i.tableData,"parentCategory");if(1===a){var o=r[n].num;return o>1?{rowspan:o,colspan:1}:o<1?{rowspan:1,colspan:o}:{rowspan:1,colspan:1}}}return o(e,n,a,r)},formatRowspanAndColspan:function(t,e){for(var n=[],a=0;a<t.length;){for(var r=0,i=a;i<t.length;i++)"parentCategory"===e&&t[a].parentCategory===t[i].parentCategory&&r++;"parentCategory"===e&&n.push({data:t[a].parentCategory,num:r}),a+=r}for(var o=0;o<n.length;o++)if(n[o].num>1||0===n[o].num)for(var l=o;l<n[o].num+o-1;l++)n.splice(l+1,0,{data:n[o].data,num:0});return n},updateFileList:function(t){console.log("扫码上传回调：",t);var e=JSON.parse(JSON.stringify(this.tableData));e.forEach((function(e,n){+t.type===n&&(e.url=e.url.concat(t.data))})),console.log(e),this.$set(this,"tableData",e)},handleDel:function(t,e){this.tableData[t].url.splice(e,1)},judgeIsPdf:function(t){var e=t.slice(-3);return"pdf"===e},handlePreview:function(t){console.log("".concat(t)),this.judgeIsPdf(t)?(this.isPdfPreview=!0,this.dialogPdfUrl=this.$utils.getFile(t)):(this.isPicturePreview=!0,this.dialogImageUrl=this.$utils.getFile(t))},handleSaveDraft:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(n,a){var r=Object(i["a"])(Object(i["a"])({},t.draftInfo),{},{otherInfo:t.form,businessType:"person"===t.$route.query.type?"1":"2",showTips:e});t.$store.dispatch("draft/saveDraft",r).then((function(){n()})).catch((function(){a()}))}))},handleNext:function(){var t=this;console.log(this.form),this.$refs["form"].validate(function(){var e=Object(s["a"])(Object(l["a"])().mark((function e(n){var a,r,o,s;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=16;break}if(a=!1,r=JSON.parse(JSON.stringify(t.tableData)),r.forEach((function(t){0===t.url.length?a=!0:t.url=t.url.join(",")})),!a){e.next=7;break}return t.$utils.showError("材料请上传完整"),e.abrupt("return");case 7:if(o=t.$utils.getItem("applicantInfo"),s=Object(i["a"])(Object(i["a"])({},o),{},{materialPath:r,industryCategory:t.$route.query.minType,channelToken:t.$utils.getLocalItem("token")}),console.log(s),"简易注销"!==t.$route.query.bizName){e.next=13;break}return Object(f["pb"])(s).then((function(e){if(500===e.errCode||"faulted"===e.state)return t.$utils.showError("提交失败，请重试！");t.$utils.removeItem("applicantInfo"),t.$utils.showSuccess("提交成功等待审核！"),t.$router.replace("/")})),e.abrupt("return");case 13:Object(f["qb"])(s).then((function(e){if(500===e.errCode||"faulted"===e.state)return t.$utils.showError("提交失败，请重试！");t.$utils.removeItem("applicantInfo"),t.$utils.showSuccess("提交成功等待审核！"),t.$router.replace("/")})),e.next=17;break;case 16:t.$utils.showError("请按提示信息补充完整表单！");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},b=p,h=(n("09c9"),n("2877")),m=Object(h["a"])(b,a,r,!1,null,"033a4ec0",null);e["default"]=m.exports},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n("06c5");function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){s=!0,o=t},f:function(){try{l||null==n["return"]||n["return"]()}finally{if(s)throw o}}}}}}]);