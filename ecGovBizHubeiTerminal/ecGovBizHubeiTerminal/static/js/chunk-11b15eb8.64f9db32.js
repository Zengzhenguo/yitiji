(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11b15eb8"],{"212d":function(e,t,r){},e92f:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"address-form"},[r("breadcrumb",{directives:[{name:"show",rawName:"v-show",value:"test"!==e.$route.query.mode,expression:"$route.query.mode !== 'test'"}]}),e._v(" "),r("div",{staticClass:"box"},[r("div",{staticClass:"title"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),r("el-form",{ref:"form",staticClass:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"94px"}},[r("el-row",{attrs:{gutter:20}},[r("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.form.naturalGasEequipmentList,"highlight-current-row":""}},[r("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{property:"deviceName",label:"设备名称",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写设备名称"},model:{value:a.deviceName,callback:function(t){e.$set(a,"deviceName",t)},expression:"row.deviceName"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"num",label:"数量",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写数量"},model:{value:a.num,callback:function(t){e.$set(a,"num",t)},expression:"row.num"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"burnerDiameter",label:"燃烧器口径",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写燃烧器口径"},model:{value:a.burnerDiameter,callback:function(t){e.$set(a,"burnerDiameter",t)},expression:"row.burnerDiameter"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"用气压力（KPA）",align:"center"}},[r("el-table-column",{attrs:{property:"work",label:"工作",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写工作"},model:{value:a.work,callback:function(t){e.$set(a,"work",t)},expression:"row.work"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"equipment",label:"设备",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写设备"},model:{value:a.equipment,callback:function(t){e.$set(a,"equipment",t)},expression:"row.equipment"}})]}}])})],1),e._v(" "),r("el-table-column",{attrs:{label:"天然气负荷（方/小时）",align:"center"}},[r("el-table-column",{attrs:{property:"normalWork",label:"正常工作",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写正常工作"},model:{value:a.normalWork,callback:function(t){e.$set(a,"normalWork",t)},expression:"row.normalWork"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{property:"fullLoad",label:"满负荷",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-input",{staticStyle:{width:"110px"},attrs:{placeholder:"请填写满负荷"},model:{value:a.fullLoad,callback:function(t){e.$set(a,"fullLoad",t)},expression:"row.fullLoad"}})]}}])})],1),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"88",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleAddRow(t.$index,t.row)}}},[e._v("\n                添加\n              ")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return e.handleDeleteRow(t.$index,t.row)}}},[e._v("\n                删除\n              ")])]}}])}),e._v(">\n        ")],1)],1),e._v(" "),r("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"预约时间",prop:"reserveTime","label-width":"140px"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"选择日期时间","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.form.reserveTime,callback:function(t){e.$set(e.form,"reserveTime",t)},expression:"form.reserveTime"}})],1)],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"网点",prop:"outlets","label-width":"120px"}},[r("div",{staticClass:"seal-adress-box"},[r("div",{staticClass:"seal-adress-list"},[r("el-radio-group",{model:{value:e.form.outlets,callback:function(t){e.$set(e.form,"outlets",t)},expression:"form.outlets"}},e._l(e.outletsList,(function(t,a){return r("el-radio",{key:a,staticClass:"seal-adress-item",attrs:{label:t.outletsName}},[r("div",{staticClass:"seal-adress-text"},[r("div",{staticStyle:{color:"#000"}},[e._v(e._s(t.outletsName)),r("span",{staticStyle:{"font-size":"14px"}},[e._v("（"+e._s(t.outletsAddr)+"）")])]),e._v(" "),r("div",{staticStyle:{"margin-top":"10px",color:"#999","font-size":"15px"}},[r("span",[e._v("联系人："+e._s(t.outletsContactPerson)+" ")]),r("span",{staticStyle:{"margin-left":"20px"}},[e._v("联系电话："+e._s(t.outletsPhone))])])])])})),1)],1)])])],1)],1),e._v(" "),r("el-form-item",{staticClass:"btn-group text-center",attrs:{"label-width":"0"}},[r("el-button",{on:{click:function(t){return e.handleSaveDraft(!0)}}},[e._v("暂存草稿")]),e._v(" "),r("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("上一步")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleNext}},[e._v("下一步，生成表单预览")])],1)],1)],1)],1)},n=[],l=(r("28a5"),r("ac6a"),r("5530")),o=r("c7eb"),s=(r("96cf"),r("1da1")),i=r("6350"),u=r("365c"),c={components:{Breadcrumb:i["a"]},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},baseInfo:{},curArea:{},type:"",rules:{reserveTime:[{required:!0,message:"请选择预约时间",trigger:"change"}],outlets:[{required:!0,message:"请选择网点",trigger:"change"}]},outletsList:[],form:{outlets:"",reserveTime:"",naturalGasEequipmentList:[{deviceName:"",num:"",burnerDiameter:"",work:"",equipment:"",normalWork:"",fullLoad:""}]}}},computed:{draftInfo:function(){return this.$store.state.draft.draftInfo},naturalGas:function(){return this.$utils.getItem("naturalGas")},businessShow:function(){return this.$utils.getItem("businessShow")}},created:function(){var e=this,t=null;t=this.$utils.getItem("nameApply").areaCode,Object(u["N"])({areacode:t,serviceProvider:"天然气"}).then((function(t){e.outletsList=t.data||[]}))},activated:function(){var e=this;this.type=this.$route.query.type,this.$utils.getLocalItem("baseInfo")&&(this.baseInfo=this.$utils.getLocalItem("baseInfo")),this.$utils.getLocalItem("curArea")&&(this.curArea=this.$utils.getLocalItem("curArea")),this.$utils.getItem("draftNumber")&&this.$store.dispatch("draft/getDraftDetail",this.$utils.getItem("draftNumber")).then(function(){var t=Object(s["a"])(Object(o["a"])().mark((function t(r){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.naturalGas&&(a=r.naturalGas,e.form=a);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{clearValidate:function(){this.$refs["form"].clearValidate()},handleAddRow:function(){this.form.naturalGasEequipmentList.push({deviceName:"",num:"",burnerDiameter:"",work:"",equipment:"",normalWork:"",fullLoad:""})},handleDeleteRow:function(e){1!==this.form.naturalGasEequipmentList.length?this.form.naturalGasEequipmentList.splice(e,1):this.$utils.showError("最少添加一条数据！")},handleSaveDraft:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(r,a){var n=Object(l["a"])(Object(l["a"])({},e.draftInfo),{},{naturalGas:e.form,businessType:"2",showTips:t});e.$store.dispatch("draft/saveDraft",n).then((function(){r()})).catch((function(){a()}))}))},handleNext:function(){var e=this;console.log(this.form),this.$refs["form"].validate(function(){var t=Object(s["a"])(Object(o["a"])().mark((function t(r){var a,n,s,i,c,d,f;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=19;break}if(a=!0,e.form.naturalGasEequipmentList.forEach((function(t){if(!t.deviceName||!t.num||!t.burnerDiameter||!t.work||!t.equipment||!t.normalWork||!t.fullLoad)return e.$utils.showError("请将表格信息补充完整！"),void(a=!1)})),a){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.handleSaveDraft();case 7:e.$utils.setItem("naturalGas",e.form),n=e.draftInfo.nameApply,s=e.draftInfo.address,i=e.draftInfo.scope,c=e.draftInfo.member,d=e.draftInfo.otherInfo,f=Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])(Object(l["a"])({},n),s),{},{scope:i},c),d),{},{industryType:{IndustryCode:n.industryFormulated.split("-")[0],IndustryName:n.industryFormulated.split("-")[2]},industryFormulated:n.industryFormulated.split("-")[1],area:n.area.join(" ")}),console.log(f),e.$loading({text:"正在获取pdf内容"}),Object(u["Y"])(f,e.$route.query.whatfrom).then((function(t){if(e.$loading().close(),500===+t.errCode||"faulted"===t.state)return e.$utils.showError("生成失败，请重试！");e.$router.push({path:"/form/preview",query:Object(l["a"])(Object(l["a"])({},e.$route.query),{},{path:t.outData.pdf})})})),t.next=20;break;case 19:e.$utils.showError("请按提示信息补充完整表单！");case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=c,f=(r("fe94"),r("2877")),m=Object(f["a"])(d,a,n,!1,null,"1f3db84a",null);t["default"]=m.exports},fe94:function(e,t,r){"use strict";r("212d")}}]);